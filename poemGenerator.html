<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç—›ãƒã‚¨ãƒ ãƒã‚§ã‚­ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@400;500&family=Yomogi&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            background-color: #fce4ec;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            font-family: 'Kiwi Maru', serif;
            touch-action: manipulation;
        }

        #cheki-area {
            background: white;
            width: 300px;
            height: 450px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            padding: 15px 15px 60px 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            box-sizing: border-box;
        }

        .photo-area {
            background: #333;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        #placeholder-text {
            color: #fff;
            font-size: 0.8rem;
            position: absolute;
            text-align: center;
            width: 100%;
            z-index: 1;
        }

        #uploaded-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0; /* åˆæœŸã¯é€æ˜ */
            z-index: 5;
            display: block;
        }

        #uploaded-img.is-loaded {
            opacity: 1; /* ç”»åƒãŒå…¥ã£ãŸã‚‰è¡¨ç¤º */
        }

        #phrase-display {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 90%;
            padding: 8px 5px;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            font-family: 'Yomogi', cursive;
            font-size: 1.15rem;
            text-align: center;
            z-index: 10;
            box-sizing: border-box;
        }

        .controls {
            margin-top: 25px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 260px;
        }

        button, .upload-label {
            padding: 12px;
            font-size: 0.9rem;
            cursor: pointer;
            background-color: #ff80ab;
            color: white;
            border: none;
            border-radius: 25px;
            box-shadow: 0 4px 0 #c94b7c;
            transition: 0.1s;
            text-align: center;
            font-weight: bold;
            display: block;
            width: 100%;
            box-sizing: border-box;
        }

        button:active, .upload-label:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #c94b7c;
        }

        #preview-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
        }

        #preview-img {
            max-width: 90%;
            max-height: 80%;
            border: 5px solid white;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .close-instruction {
            margin-top: 15px;
            font-size: 0.9rem;
            background: #4fc3f7;
            padding: 8px 20px;
            border-radius: 20px;
        }

        .download-btn {
            background-color: #4fc3f7;
            box-shadow: 0 4px 0 #0288d1;
        }

        #imageInput { display: none; }
    </style>
</head>
<body>

    <div id="cheki-area">
        <div class="photo-area">
            <span id="placeholder-text">è‡ªæ’®ã‚Šç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„<br>ï¼ˆã§ãã‚Œã°ä»–äººã®ï¼‰</span>
            <img id="uploaded-img" src="" alt="">
            <div id="phrase-display"></div>
        </div>
    </div>

    <div class="controls">
        <label class="upload-label">
            è‡ªæ’®ã‚Šã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
            <input type="file" id="imageInput" accept="image/*">
        </label>
        <button onclick="generatePoem()">ãƒ•ãƒ¬ãƒ¼ã‚ºç”Ÿæˆ</button>
        <button class="download-btn" onclick="downloadCheki()">ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    </div>

    <div id="preview-overlay" onclick="this.style.display='none'">
        <p>ç”»åƒã‚’é•·æŠ¼ã—ã—ã¦ã€Œå†™çœŸã«è¿½åŠ ã€ã—ã¦ã­</p>
        <img id="preview-img" src="" alt="preview">
        <div class="close-instruction">ã‚¿ãƒƒãƒ—ã§é–‰ã˜ã‚‹</div>
    </div>

    <script>
        const dictionary = {
            intro: [
							"ã­ã‡ã€",
							"åˆå‰2æ™‚ã®",
							"ä¸–ç•Œã§ä¸€ç•ª",
							"æ•‘ã„ã‚ˆã†ã®ãªã„",
							"å›ã¨ã„ã†åã®",
							"è¦–ç·šãŒåˆã†ãŸã³",
							"é€æ˜ãªç§ã®",
							"çœ ã‚Œãªã„å¤œ",
							"å¥½ãã¨å«Œã„ã®",
							"è™šç„¡ã®ä¸–ç•Œ",
							"ä½•ã‚‚ã‹ã‚‚ãŒè™šåƒ",
							"è™ã’ã‚‰ã‚ŒãŸ",
							"ãˆã€ã¾ã£ã¦",
							"è‰ã®ä¸Šã§",
							"ãã¿ã®æ¾„ã‚“ã ç³",
							"æ˜ã‹ã‚Šã®ãªã„ä¸–ç•Œ",
							"æ±‚ã‚ã‚‰ã‚Œã¦ã„ãªã„",
							"ç”Ÿãã¦ã„ã‚‹æ„å‘³",
							"ã™ã‚Œé•ã„ã®",
							"ã‹ãé›†ã‚ãŸ",
							"ã¨ã‚ã‘ã‚‹ã‚ˆã†ãª",
							"ã“ã‚Œã£ã¦",
							"ç”Ÿã¾ã‚Œå¤‰ã‚ã£ãŸã‚‰",
							"ã“ã®ä¸–ç•Œã®",
							"ä¸­äºŒã¨è¨€ã‚ã‚Œã¦ã‚‚",
							"ç‡ƒãˆã¤ãã™ã»ã©",
							"ã“ã®ä¸–ã«ãµãŸã¤ã¨ãªã„",
							"æ¯”ã¹ã‚ˆã†ãŒãªãã¦ã‚‚",
							"ã—ã‚…ãã´ã¨",
							"å…ˆç¥–ä»£ã€…ä¸€æ—æœ«è£”ã¾ã§",
							"ä¸–ç•Œã˜ã‚…ã†ã‚’æ•µã«å›ã—ã¦ã‚‚",
							"ä¸–ç•ŒãŒçµ‚ã‚ã£ãŸã¨ã—ã¦ã‚‚",
							"èª°ã‹ã‚‰ã‚‚å¿…è¦ã¨ã•ã‚Œã¦ã„ãªã„",
							"é€šçŸ¥ãŒé³´ã‚‹ãŸã³ã«",
							"ãƒãƒƒãƒˆã®ä¸­ã ã‘ã§",
							"ã­ã‡ã€èã„ã¦ã‚‹ï¼Ÿ",
							"é€ƒã’ã‚‰ã‚Œãªã„",
							"ç¥æ§˜ã•ãˆã‚‚",
							"æ¶²æ™¶è¶Šã—ã«è¦‹ãŸ",
							"å£Šã‚ŒãŸã¾ã¾ã®",
							"è¡€ã®æ··ã˜ã£ãŸ",
							"0.1ç§’ã®",
							"ã‚ã®æ—¥èª“ã£ãŸ",
							"ã‚´ãƒŸæºœã‚ã®ã‚ˆã†ãª",
							"èª°ã«ã‚‚è¨€ãˆãªã„",
							"å¢“ã¾ã§æŒã£ã¦ã„ãã¤ã‚‚ã‚Š",
							"ã‚‚ã†5å¹´ã‚‚å‰",
							"éœ‡ãˆã‚‹ã»ã©ã®",
							"è€ãˆãã‚Œãªã„",
							"ç”Ÿã¾ã‚Œã‚‹ä»¥å‰ã‹ã‚‰",
							"æ†ã—ã¿ã•ãˆ",
							"ã‚‚ã†æˆ»ã‚Œãªã„",
							"æ­»ã«ãŸã„ãã‚‰ã„",
							"å£Šã‚Œã‚‹ãã‚‰ã„"
						],
            core: ["å…±ä¾å­˜",
							"è„³å†…éº»è–¬",
							"ä¸€ç”Ÿã®ç½ª",
							"æœ‰å®³ãªæ„›",
							"ã‚ãªãŸã®ç”Ÿå‘½ï¼ˆã„ã®ã¡ï¼‰",
							"ãƒ„ãƒŠç¼¶ã¨é–“é•ãˆãŸçŒ«ç¼¶",
							"é­”æ³•",
							"å‘ªã„",
							"å„ä»‹",
							"èª¬æ•™",
							"ã»ã¤ã‚ŒãŸä¸‹ç€",
							"åˆæœŸå‹ã®ã‚¢ãƒƒãƒ—ãƒ«ã‚¦ã‚©ãƒƒãƒ",
							"ã‚»ã‚¯ãƒãƒ©",
							"ã‚¿ãƒ³ãƒ‘ã‚¯è³ª",
							"åŸæ¶²ã®ã‚«ãƒ«ãƒ”ã‚¹",
							"å±¥ãç¶šã‘ãŸãã¤ä¸‹",
							"ãªã¾ç‰¡è £",
							"ã¨ã‚“ã‹ã¤ã®è„‚èº«",
							"å¾Œæ‚”ã®ã‚¿ãƒˆã‚¥ãƒ¼",
							"æ´—ã£ã¦ãªã„ãƒ”ã‚¢ã‚¹",
							"æ–­ç½ª",
							"æ¯’è¦ª",
							"å‚·ã‚“ã é«ª",
							"æ²»ã‚‰ãªã„ãŠã­ã—ã‚‡",
							"éš ã—ã¦ã„ãŸBLæœ¬",
							"é¢¨ä¿—ã¨é–“é•ã‚ã‚Œã‚‹",
							"ã“ã®é•·ã„ãƒã‚¤ãƒ«ã®ã²ã¿ã¤",
							"ã½ã£ã‹ã‚Šã¨ç©ºã„ãŸç©´",
							"ADHDã®æ¨©åŒ–",
							"èª°ã‚‚ãŒæŒ¯ã‚Šå‘ããƒ–ã‚¹",
							"ã‹ã‚ã„ã„å¥³",
							"æ­¢ã¾ã‚‰ãªã„æ•´å½¢",
							"8å›ç›®ã®ãƒ€ã‚¤ã‚¨ãƒƒãƒˆ",
							"ãªã‘ãªã—ã®åƒå††æœ­",
							"ä»Šæ›´è¦šãˆãŸä¸‰è§’é–¢æ•°",
							"èºé¬±ã¨ä¸çœ ç—‡",
							"è¶³ã‚Šãªã„é ­",
							"ç©¢ã‚ŒãŸå¿ƒ",
							"æ’æ°´å£ã®ã¬ã‚ã‚Š",
							"æ’æ°´å£ã«è©°ã¾ã£ãŸé«ªã®æ¯›",
							"é¢¨å‘‚ã‚­ãƒ£ãƒ³äº”æ—¥ç›®",
							"ã€†ã®ãƒ©ãƒ¼ãƒ¡ãƒ³",
							"ãƒˆã‚¤ãƒ¬ã§ç´™ãŒãªã„çµ¶æœ›",
							"é…”ã£ã¦å¤±ãã—ãŸè¨˜æ†¶",
							"æœ‰ã‚Šä½™ã‚‹è„‚è‚ª",
							"åå††ãƒã‚²",
							"æ¯›ã®ç”ŸãˆãŸå¿ƒè‡“",
							"å¹¼å°‘æœŸã®è™å¾…",
							"æš—é»’ã®æ—¥ã€…",
							"æœªæ‰•ã„ã®çµ¦æ–™",
							"é€ƒã‚Œã‚‰ã‚Œã¬å®¿å‘½ï¼ˆã•ã ã‚ï¼‰",
							"å†·ã‚ãŸã‹ã‚‰ã‚ã’ãã‚“",
							"é£²ã¿ãŸããªã„ãƒ†ã‚­ãƒ¼ãƒ©",
							"æº¶ã‘ãŸæ™‚é–“",
							"æ¯å¤œä¸€äººã§ãŸã¹ãŸè“å­ãƒ‘ãƒ³",
							"æº¶ã‘ãªã„ç‰‡æ —ç²‰",
							"ã“ã¼ã‚ŒãŸã‚¤ã‚¯ãƒ©",
							"æº€ãŸã•ã‚Œã¬æ¬²æœ›",
							"è–¬ã«æººã‚Œã¦ã‚‹æ—¥ã€…",
							"ç”Ÿã¾ã‚Œã¤ãã®è²§ä¹",
							"ã„ã¤ã‚‚é‡‘æ¬ ",
							"ç–‘ã‚ã‚Œã‚‹äººé–“æ€§",
							"ç”˜ã„ç½ ",
							"17æ­³ã®æ™‚ã®ç§",
							"ãƒ„ã‚¤å»ƒ",
							"ç†æƒ³ã¨ç¾å®Ÿ",
							"ã‚¯ãƒ¬ã‚«ã®è«‹æ±‚",
							"è²¡å¸ƒã®ä¸­ã®ãƒ¬ã‚·ãƒ¼ãƒˆã®æŸ",
							"ãƒãƒ¨ãƒãƒ¼ã‚ºå‘³",
							"å™›ã¿çµ‚ãˆãŸã‚¬ãƒ ",
							"ä»Šæ—¥ã‚‚ã‚¦ãƒ¼ãƒãƒ¼",
							"ä½¿ã„å¤ã—ãŸã‚¨ã‚¯ã‚¹ãƒ†",
							"å¸Œæ­»å¿µæ…®",
							"é£²ã¿è¾¼ã‚“ã ãƒ”ã‚¢ã‚¹ã®ã‚­ãƒ£ãƒƒãƒ",
							"è³å‘³æœŸé™åˆ‡ã‚Œã®ã‚³ãƒ³ãƒ“ãƒ‹å¼å½“",
							"è‡ªå‚·è‡ªè™",
							"15æ™‚é–“ã®ç¡çœ ",
							"é‡ã™ãã‚‹ç‹¬å æ¬²",
							"éš›é™ãªã„æ‰¿èªæ¬²æ±‚",
							"æ¬ ã‘ãŸå‰æ­¯",
							"è‡´æ­»é‡ã®è‚‰",
							"å¸ã„ã‹ã‘ã®é›»å­ã‚¿ãƒã‚³",
							"å£²ã‚‹ã»ã©ã‚ã‚‹æŠ—ã†ã¤å‰¤",
							"ã„ã¤ã‚‚ä½¿ã„æ¨ã¦ã‚‰ã‚Œã‚‹è‡ªåˆ†",
							"è…ã‚Šã‹ã‘ã®åµ",
							"èª°ã«ã¨ã£ã¦ã‚‚åœ°é›·",
							"æœªèª­ç„¡è¦–ã§ä¸€é€±é–“",
							"ãã£ã¨ãƒãƒ¬ã¦ã‚‹è£å¢",
							"å¢—ãˆã¦ã„ãå€Ÿç”¨æ›¸",
							"å‹é”ã¨ä¸€ç·’ã®å†™çœŸãŒä¸€æšã‚‚ãªã„"
						],
            outro: ["â€¦â€¦ã‚ã’ã‚‹",
							"ã€€ã„ã¤ã‚‚éœ‡ãˆã¦ã‚‹",
							"ã€€æ³£ã„ã¦ã‚‚ã„ã„ï¼Ÿ",
							"ã€€æ¶™ã®æ•°ã ã‘æ®´ã‚‰ã›ã¦",
							"ã€æ•™ãˆã¦ï¼Ÿ",
							"ã ã‘ã§æº€ãŸã—ã¦",
							"ã®å…±çŠ¯è€…ã«ãªã‚ã†",
							"ä»¥å¤–ã€è¦ã‚‰ãªã„",
							"ã€ã•ã›ã¦ã‚ˆ",
							"ã‚’ã€ã‚ã’ã‚‹ã­â™¡",
							"ã€ã‚‚ã†ã—ã«ãŸã„",
							"ã€å¸°ã‚Œãªã„",
							"ã€ãã†ã€æ‹ã—ã¦ã‚‹",
							"ã€ãã‚“ãªæ°—åˆ†",
							"ã€å…±å­˜ã™ã‚‹ã—ã‹ãªã„",
							"ã€ãŸã¶ã‚“ã€æ­»ã¬ã¾ã§",
							"ã€€å¤¢ã«è¦‹ãã†",
							"ã€æ­»å¾Œã®ä¸–ç•Œï¼Ÿ",
							"ã€€ã„ã„åŠ æ¸›ã«ã—ã¦",
							"ã€€ã‚‚ã†ã€çµ‚ã‚ã‚Šã­",
							"ã€€ä½•ã‚‚èã“ãˆãªã„",
							"ã€€å¾…ã£ã¦ã¦...",
							"ã€€ãã®è‹¦ã—ã¿ã ã‘",
							"ã‚’å¦å®šã¯ã—ãªã„",
							"ã€€ãŸã ã€ãã‚Œã ã‘",
							"ã€€ãã†ã€ã ã‹ã‚‰é»™ã£ã¦ã¦",
							"ã€ãã‚ŒãŒã‚ãŸã—ã®ç­”ãˆ",
							"ã€€ã‚‚ã†ä¸€åº¦è¨€ã£ã¦",
							"ã€€ãŠäº’ã„ã•ã¾",
							"ã€€ãšã£ã¨ç¬‘é¡”ã§ã„ã‚‰ã‚Œã‚‹",
							"ã€€ã†ã‚“ã€ã„ã„ã‚ˆâ€¦",
							"ã€€æœã¾ã§èª¿æ•™ã™ã‚‹ï¼Ÿ",
							"ã€€æ³•å»·ã§ä¼šã„ã¾ã—ã‚‡ã†",
							"ã€æ­»ã¬ã¾ã§ãã‚Œ",
							"ã€€ã„ã¤ã‚‚ãƒ”ãƒ³ã‚¯è‰²",
							"ã€€ç›®ã®å‰ã®çµ¶æœ›",
							"ã€€ã ã‹ã‚‰,ã—ã‚“ã§ã»ã—ã„",
							"ã®ã¾ã¾ã§ã„ã•ã›ã¦",
							"ã€€è¦‹ãŸã„ã®ï¼Ÿ",
							"ã‹ã‚‰é€ƒã’ãªã„ã§ï¼",
							"ã€€ã‹ã‚“ã¹ã‚“ã—ã¦ã­",
							"ã€€å‹é”ãªã‚“ã¦ã„ã‚‰ãªã„",
							"ã€€ãã‚ŒãŒç ´æ»…",
							"ã€€ãœã‚“ã¶å˜˜",
							"ã€€æ¥ä¸–ã§å‡ºç›´ã—ã¦ãã¦",
							"ã€çµ‚ã‚ã‚‰ãªã„è‹¦ã—ã¿",
							"ã€æœ¬æ°—ã®ãŠã­ãŒã„",
							"ã€ã»ã‚“ã¨ã«æ°—æŒã¡æ‚ªã„",
							"ã€€ã¾ã ã¾ã ã“ã‚Œã‹ã‚‰",
							"ã€æ±šã‚‰ã‚ã—ã„",
							"ã€ã“ã‚Œã§æº€è¶³ï¼Ÿ",
							"ã€€ãã‚Œã ã‘ãŒçœŸå®Ÿ",
							"ã€€åœ°ç„ã§å¾…ã£ã¦ã‚‹",
							"ã€€ã‚‚ã†é™ç•Œ",
							"ã€€ä¸€ç·’ã«ã—ã‚“ã§",
							"ã€€è¦–ç•Œã«å…¥ã‚ŒãŸããªã„",
							"ã€€5000å…†å††æ¬²ã—ã„",
							"ã€€åƒããŸããªã„",
							"ã€€ã‚‚ã†é™ç•Œ",
							"ã€€ã„ã£ãæ®ºã—ã¦ã»ã—ã„",
							"...æ•‘ã£ã¦ã¿ã›ã¦",
							"ã€€ä¸–ç•ŒãŒæ»…ã³ã‚Œã°ã„ã„ã®ã«",
							"ã€€ãªã‚“ã¦ã€å˜˜",
							"ã€€ã‚‚ã†æŒ¯ã‚Šè¿”ã‚‰ãªã„",
							"ã€å…¨éƒ¨ãƒªã‚»ãƒƒãƒˆï¼",
							"ã€€ã‚·ãƒ³ãƒ—ãƒ«ã«ã—ã­",
							"ã€€æ‰¿èªæ¬²æ±‚ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼",
							"ã€€åœ°ç„ã®åŸ·è¡Œäºº",
							"ã€€ã¾ã ã¾ã çœ ã„",
							"ã€€ãªãƒ¼ã‚“ã¦ã€å…¨éƒ¨ã†ã",
							"ã€€è¨€ã„è¨³ãªã‚“ã¦ã„ã‚‰ãªã„",
							"ã£ã¦ã‚³ãƒˆï¼Ÿï¼Ÿ",
							"ã§ã—ã‚‡ï¼Ÿ"
						],
            symbols: ["â™¡",
							"âœï¸",
							"â„ï¸",
							"ğŸ€",
							"ğŸ­",
							"ğŸ’‰",
							"ğŸ”ª",
							"ğŸ¤",
							""
						]
        };

        const imageInput = document.getElementById('imageInput'); // ã“ã‚ŒãŒå¿…è¦ã§ã—ãŸï¼

        // ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        imageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = document.getElementById('uploaded-img');
                    img.src = event.target.result;
                    img.classList.add('is-loaded'); 
                    document.getElementById('placeholder-text').style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        });

        // ãƒ•ãƒ¬ãƒ¼ã‚ºç”Ÿæˆ
        function generatePoem() {
            const i = dictionary.intro[Math.floor(Math.random() * dictionary.intro.length)];
            const c = dictionary.core[Math.floor(Math.random() * dictionary.core.length)];
            const o = dictionary.outro[Math.floor(Math.random() * dictionary.outro.length)];
            const s = dictionary.symbols[Math.floor(Math.random() * dictionary.symbols.length)]; 

            const display = document.getElementById('phrase-display');
            display.innerHTML = `${i}<br>${c}${o}${s}`;

            const colors = ['#ffffff', '#ff88dd', '#cccccc', '#00ffff', '#ffff00', '#7fff00', '#ff99cc', '#ffdb00'];
            const selectedColor = colors[Math.floor(Math.random() * colors.length)];
            display.style.color = selectedColor;

            const outlineColor = (selectedColor === '#ffffff') ? '#ff007f' : '#000000';
            display.style.textShadow = `1px 1px 0 ${outlineColor}, -1px -1px 0 ${outlineColor}, 1px -1px 0 ${outlineColor}, -1px 1px 0 ${outlineColor}`;

            const randomRotate = Math.floor(Math.random() * 4) - 2; 
            display.style.transform = `rotate(${randomRotate}deg)`;
        }

        // ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
				function downloadCheki() {
				    const chekiArea = document.getElementById('cheki-area');
				    const downloadBtn = document.querySelector('.download-btn');
				    const originalText = downloadBtn.innerText;
				    
				    downloadBtn.innerText = "ç”Ÿæˆä¸­...";

				    // è¤‡é›‘ãªåº§æ¨™è¨ˆç®—ï¼ˆrect.leftãªã©ï¼‰ã‚’ã‚„ã‚ã€è¦ç´ ãã®ã‚‚ã®ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã™ã‚‹
				    html2canvas(chekiArea, {
				        scale: 3,             // é«˜ç”»è³ªåŒ–
				        useCORS: true,        // å¤–éƒ¨ç”»åƒå¯¾å¿œ
				        backgroundColor: "#ffffff",
				        // åº§æ¨™æŒ‡å®š(x, y)ã‚’ã‚ãˆã¦å¤–ã™ã“ã¨ã§ã€html2canvasã®è‡ªå‹•è¨ˆç®—ã«ä»»ã›ã‚‹
				        // ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã®å¹…ã«é–¢ä¿‚ãªãè¦ç´ å˜ä½“ã‚’åˆ‡ã‚Šå–ã‚Œã¾ã™
				        logging: false,
				        width: 300,           // ãƒã‚§ã‚­ã®æ¨ªå¹…
				        height: 450,          // ãƒã‚§ã‚­ã®ç¸¦å¹…
				    }).then(canvas => {
				        const previewOverlay = document.getElementById('preview-overlay');
				        const previewImg = document.getElementById('preview-img');
				        
				        previewImg.src = canvas.toDataURL('image/png');
				        previewOverlay.style.display = 'flex';
				        
				        downloadBtn.innerText = originalText;
				    }).catch(err => {
				        console.error("ç”Ÿæˆå¤±æ•—:", err);
				        downloadBtn.innerText = originalText;
				    });
				}

        generatePoem();
    </script>
</body>
</html>